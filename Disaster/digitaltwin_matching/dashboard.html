<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ë…¸ê·¸ë¦¬ë“œ AI ë””ì§€í„¸ íŠ¸ìœˆ</title>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .metric-card h3 {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-value.green { color: #4CAF50; }
        .metric-value.blue { color: #2196F3; }
        .metric-value.orange { color: #FF9800; }
        .metric-value.purple { color: #9C27B0; }
        
        .metric-unit {
            color: #999;
            font-size: 0.8em;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .control-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        select, input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
        }
        
        .agent-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .agent-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .agent-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4CAF50;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .info-list {
            list-style: none;
            padding: 0;
        }
        
        .info-list li {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
        }
        
        .info-list li:last-child {
            border-bottom: none;
        }
        
        .info-label {
            color: #888;
        }
        
        .info-value {
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ« ë‚˜ë…¸ê·¸ë¦¬ë“œ AI ë””ì§€í„¸ íŠ¸ìœˆ</h1>
            <p>ì‹¤ì‹œê°„ ìˆ˜ìš”-ê³µê¸‰ ì—ë„ˆì§€ ë§¤ì¹­ ë° ì œì–´ ì•Œê³ ë¦¬ì¦˜ ëª¨ë‹ˆí„°ë§</p>
        </div>
        
        <div class="metrics">
            <div class="metric-card">
                <h3>í‰ê·  ì „ë ¥ ìˆ˜ìš”</h3>
                <div class="metric-value blue" id="avgDemand">0</div>
                <div class="metric-unit">kW</div>
            </div>
            <div class="metric-card">
                <h3>í‰ê·  ì „ë ¥ ê³µê¸‰</h3>
                <div class="metric-value green" id="avgSupply">0</div>
                <div class="metric-unit">kW</div>
            </div>
            <div class="metric-card">
                <h3>ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨</h3>
                <div class="metric-value orange" id="renewableRatio">0</div>
                <div class="metric-unit">%</div>
            </div>
            <div class="metric-card">
                <h3>ì¢…í•© ì„±ëŠ¥ ì ìˆ˜</h3>
                <div class="metric-value purple" id="overallScore">0</div>
                <div class="metric-unit">/ 100</div>
            </div>
        </div>
        
        <div class="agent-status">
            <div class="agent-card">
                <h3>
                    <span class="status-indicator"></span>
                    ìˆ˜ìš” ë°˜ì‘ AI ì—ì´ì „íŠ¸
                </h3>
                <ul class="info-list">
                    <li>
                        <span class="info-label">í™œì„± ë””ë°”ì´ìŠ¤</span>
                        <span class="info-value" id="activeDevices">0</span>
                    </li>
                    <li>
                        <span class="info-label">ì œì–´ ê°€ëŠ¥ ë””ë°”ì´ìŠ¤</span>
                        <span class="info-value" id="controllableDevices">48</span>
                    </li>
                    <li>
                        <span class="info-label">í‰ê·  ìš°ì„ ìˆœìœ„</span>
                        <span class="info-value" id="avgPriority">5.0</span>
                    </li>
                </ul>
            </div>
            
            <div class="agent-card">
                <h3>
                    <span class="status-indicator"></span>
                    ê³µê¸‰ ìµœì í™” AI ì—ì´ì „íŠ¸
                </h3>
                <ul class="info-list">
                    <li>
                        <span class="info-label">íƒœì–‘ê´‘ ë°œì „</span>
                        <span class="info-value" id="solarPower">0 kW</span>
                    </li>
                    <li>
                        <span class="info-label">í’ë ¥ ë°œì „</span>
                        <span class="info-value" id="windPower">0 kW</span>
                    </li>
                    <li>
                        <span class="info-label">ESS SOC</span>
                        <span class="info-value" id="essSOC">60%</span>
                    </li>
                </ul>
            </div>
            
            <div class="agent-card">
                <h3>
                    <span class="status-indicator"></span>
                    ê°€ê²© ê²°ì • AI ì—ì´ì „íŠ¸
                </h3>
                <ul class="info-list">
                    <li>
                        <span class="info-label">í˜„ì¬ ì „ë ¥ ê°€ê²©</span>
                        <span class="info-value" id="currentPrice">100 ì›/kWh</span>
                    </li>
                    <li>
                        <span class="info-label">ìˆ˜ê¸‰ ê· í˜•</span>
                        <span class="info-value" id="supplyDemandRatio">1.0</span>
                    </li>
                    <li>
                        <span class="info-label">ë¹„ìš© íš¨ìœ¨ì„±</span>
                        <span class="info-value" id="costEfficiency">100%</span>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">ğŸ“Š ì‹¤ì‹œê°„ ì „ë ¥ ìˆ˜ìš”-ê³µê¸‰ ì¶”ì´</div>
            <div id="powerChart"></div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">ğŸŒ± ì¬ìƒì—ë„ˆì§€ ë°œì „ëŸ‰ ë° í™˜ê²½ ë°ì´í„°</div>
            <div id="renewableChart"></div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">ğŸ”‹ ESS ìƒíƒœ ë° ì „ë ¥ ê· í˜•</div>
            <div id="essChart"></div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">âš¡ ì„±ëŠ¥ ì§€í‘œ ì¶”ì´</div>
            <div id="metricsChart"></div>
        </div>
    </div>
    
    <script>
        // ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ë¡œë“œ ë° ì‹œê°í™”
        async function loadData() {
            try {
                const response = await fetch('smart_grid_simulation_results.csv');
                const csvText = await response.text();
                const data = parseCSV(csvText);
                
                updateMetrics(data);
                createPowerChart(data);
                createRenewableChart(data);
                createESSChart(data);
                createMetricsChart(data);
                
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }
        
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index];
                });
                data.push(row);
            }
            
            return data;
        }
        
        function updateMetrics(data) {
            const avgDemand = data.reduce((sum, row) => sum + parseFloat(row['ì „ë ¥ìˆ˜ìš”']), 0) / data.length;
            const avgSupply = data.reduce((sum, row) => sum + parseFloat(row['ì „ë ¥ê³µê¸‰']), 0) / data.length;
            const avgRenewable = data.reduce((sum, row) => sum + parseFloat(row['ì¬ìƒì—ë„ˆì§€ë¹„ìœ¨']), 0) / data.length;
            const avgScore = data.reduce((sum, row) => sum + parseFloat(row['ì¢…í•©ì ìˆ˜']), 0) / data.length;
            
            document.getElementById('avgDemand').textContent = avgDemand.toFixed(1);
            document.getElementById('avgSupply').textContent = avgSupply.toFixed(1);
            document.getElementById('renewableRatio').textContent = avgRenewable.toFixed(1);
            document.getElementById('overallScore').textContent = avgScore.toFixed(1);
            
            // ë§ˆì§€ë§‰ ë°ì´í„°ë¡œ ì‹¤ì‹œê°„ ì •ë³´ ì—…ë°ì´íŠ¸
            const lastRow = data[data.length - 1];
            document.getElementById('essSOC').textContent = parseFloat(lastRow['ESS_SOC']).toFixed(1) + '%';
            document.getElementById('currentPrice').textContent = parseFloat(lastRow['ê°€ê²©']).toFixed(0) + ' ì›/kWh';
            document.getElementById('costEfficiency').textContent = parseFloat(lastRow['ë¹„ìš©íš¨ìœ¨ì„±']).toFixed(1) + '%';
        }
        
        function createPowerChart(data) {
            const times = data.map(row => row['ì‹œê°']);
            const demand = data.map(row => parseFloat(row['ì „ë ¥ìˆ˜ìš”']));
            const supply = data.map(row => parseFloat(row['ì „ë ¥ê³µê¸‰']));
            const balance = data.map(row => parseFloat(row['ì „ë ¥ê· í˜•']));
            
            const trace1 = {
                x: times,
                y: demand,
                name: 'ì „ë ¥ ìˆ˜ìš”',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#2196F3', width: 3 },
                marker: { size: 6 }
            };
            
            const trace2 = {
                x: times,
                y: supply,
                name: 'ì „ë ¥ ê³µê¸‰',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#4CAF50', width: 3 },
                marker: { size: 6 }
            };
            
            const trace3 = {
                x: times,
                y: balance,
                name: 'ì „ë ¥ ê· í˜•',
                type: 'scatter',
                mode: 'lines',
                line: { color: '#FF9800', width: 2, dash: 'dash' },
                yaxis: 'y2'
            };
            
            const layout = {
                xaxis: { 
                    title: 'ì‹œê°„',
                    tickangle: -45
                },
                yaxis: { 
                    title: 'ì „ë ¥ (kW)',
                    side: 'left'
                },
                yaxis2: {
                    title: 'ê· í˜• (kW)',
                    overlaying: 'y',
                    side: 'right'
                },
                legend: {
                    x: 0.5,
                    y: 1.1,
                    xanchor: 'center',
                    orientation: 'h'
                },
                hovermode: 'x unified',
                height: 400
            };
            
            Plotly.newPlot('powerChart', [trace1, trace2, trace3], layout);
        }
        
        function createRenewableChart(data) {
            const times = data.map(row => row['ì‹œê°']);
            const solar = data.map(row => parseFloat(row['ì¼ì‚¬ëŸ‰']));
            const wind = data.map(row => parseFloat(row['í’ì†']));
            const renewable = data.map(row => parseFloat(row['ì¬ìƒì—ë„ˆì§€ë¹„ìœ¨']));
            
            const trace1 = {
                x: times,
                y: solar,
                name: 'ì¼ì‚¬ëŸ‰ (W/mÂ²)',
                type: 'scatter',
                fill: 'tozeroy',
                line: { color: '#FFC107' },
                yaxis: 'y'
            };
            
            const trace2 = {
                x: times,
                y: wind,
                name: 'í’ì† (m/s)',
                type: 'scatter',
                fill: 'tozeroy',
                line: { color: '#00BCD4' },
                yaxis: 'y'
            };
            
            const trace3 = {
                x: times,
                y: renewable,
                name: 'ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨ (%)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#4CAF50', width: 3 },
                marker: { size: 6 },
                yaxis: 'y2'
            };
            
            const layout = {
                xaxis: { 
                    title: 'ì‹œê°„',
                    tickangle: -45
                },
                yaxis: { 
                    title: 'í™˜ê²½ ë°ì´í„°',
                    side: 'left'
                },
                yaxis2: {
                    title: 'ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨ (%)',
                    overlaying: 'y',
                    side: 'right'
                },
                legend: {
                    x: 0.5,
                    y: 1.1,
                    xanchor: 'center',
                    orientation: 'h'
                },
                hovermode: 'x unified',
                height: 400
            };
            
            Plotly.newPlot('renewableChart', [trace1, trace2, trace3], layout);
        }
        
        function createESSChart(data) {
            const times = data.map(row => row['ì‹œê°']);
            const soc = data.map(row => parseFloat(row['ESS_SOC']));
            const balance = data.map(row => parseFloat(row['ì „ë ¥ê· í˜•']));
            
            const trace1 = {
                x: times,
                y: soc,
                name: 'ESS SOC (%)',
                type: 'scatter',
                fill: 'tozeroy',
                line: { color: '#9C27B0', width: 3 },
                marker: { size: 6 }
            };
            
            const trace2 = {
                x: times,
                y: balance,
                name: 'ì „ë ¥ ê· í˜• (kW)',
                type: 'bar',
                marker: {
                    color: balance.map(v => v >= 0 ? '#4CAF50' : '#F44336')
                },
                yaxis: 'y2'
            };
            
            const layout = {
                xaxis: { 
                    title: 'ì‹œê°„',
                    tickangle: -45
                },
                yaxis: { 
                    title: 'SOC (%)',
                    side: 'left'
                },
                yaxis2: {
                    title: 'ì „ë ¥ ê· í˜• (kW)',
                    overlaying: 'y',
                    side: 'right'
                },
                legend: {
                    x: 0.5,
                    y: 1.1,
                    xanchor: 'center',
                    orientation: 'h'
                },
                hovermode: 'x unified',
                height: 400
            };
            
            Plotly.newPlot('essChart', [trace1, trace2], layout);
        }
        
        function createMetricsChart(data) {
            const times = data.map(row => row['ì‹œê°']);
            const renewable = data.map(row => parseFloat(row['ì¬ìƒì—ë„ˆì§€ë¹„ìœ¨']));
            const stability = data.map(row => parseFloat(row['ì•ˆì •ì„±ì ìˆ˜']));
            const cost = data.map(row => parseFloat(row['ë¹„ìš©íš¨ìœ¨ì„±']));
            const overall = data.map(row => parseFloat(row['ì¢…í•©ì ìˆ˜']));
            
            const trace1 = {
                x: times,
                y: renewable,
                name: 'ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨',
                type: 'scatter',
                mode: 'lines',
                line: { color: '#4CAF50', width: 2 }
            };
            
            const trace2 = {
                x: times,
                y: stability,
                name: 'ì•ˆì •ì„±',
                type: 'scatter',
                mode: 'lines',
                line: { color: '#2196F3', width: 2 }
            };
            
            const trace3 = {
                x: times,
                y: cost,
                name: 'ë¹„ìš© íš¨ìœ¨ì„±',
                type: 'scatter',
                mode: 'lines',
                line: { color: '#FF9800', width: 2 }
            };
            
            const trace4 = {
                x: times,
                y: overall,
                name: 'ì¢…í•© ì ìˆ˜',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9C27B0', width: 3 },
                marker: { size: 6 }
            };
            
            const layout = {
                xaxis: { 
                    title: 'ì‹œê°„',
                    tickangle: -45
                },
                yaxis: { 
                    title: 'ì ìˆ˜',
                    range: [0, 150]
                },
                legend: {
                    x: 0.5,
                    y: 1.1,
                    xanchor: 'center',
                    orientation: 'h'
                },
                hovermode: 'x unified',
                height: 400
            };
            
            Plotly.newPlot('metricsChart', [trace1, trace2, trace3, trace4], layout);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
        window.addEventListener('load', loadData);
    
    // Real-time data update function
    function updateRealTimeData() {
        // Generate realistic virtual data
        const now = new Date();
        const hour = now.getHours();
        
        // Simulate daily patterns
        const demandBase = 50 + Math.sin((hour - 6) * Math.PI / 12) * 30;
        const supplyBase = 60 + Math.sin((hour - 8) * Math.PI / 12) * 25;
        const solarBase = hour >= 6 && hour <= 18 ? (hour - 6) * 5 : 0;
        const windBase = 15 + Math.random() * 10;
        
        // Average power demand (with variation)
        const avgDemand = demandBase + (Math.random() - 0.5) * 10;
        document.getElementById('avgDemand').textContent = Math.round(avgDemand);
        
        // Average power supply (with variation)
        const avgSupply = supplyBase + (Math.random() - 0.5) * 8;
        document.getElementById('avgSupply').textContent = Math.round(avgSupply);
        
        // Renewable energy ratio
        const renewableRatio = Math.min(100, Math.round((solarBase + windBase) / avgDemand * 100));
        document.getElementById('renewableRatio').textContent = renewableRatio;
        
        // Performance score (based on balance and renewable ratio)
        const balance = Math.abs(avgDemand - avgSupply) / Math.max(avgDemand, avgSupply);
        const performanceScore = Math.round((1 - balance) * 50 + (renewableRatio / 100) * 50);
        document.getElementById('performanceScore').textContent = performanceScore;
        
        // Active devices (simulate)
        const activeDevices = Math.floor(20 + Math.random() * 20);
        document.querySelector('.agent-card:first-child .agent-value').textContent = activeDevices;
        
        // Solar generation
        const solarGen = Math.max(0, solarBase + (Math.random() - 0.5) * 5);
        document.querySelector('.agent-card:nth-child(2) .agent-value').textContent = Math.round(solarGen) + ' kW';
        
        // Wind generation
        const windGen = Math.max(0, windBase + (Math.random() - 0.5) * 5);
        document.querySelector('.agent-card:nth-child(2) .agent-value:nth-child(3)').textContent = Math.round(windGen) + ' kW';
        
        // ESS SOC
        const essSOC = Math.min(100, Math.max(0, 60 + (Math.random() - 0.5) * 10));
        document.querySelector('.agent-card:nth-child(2) .agent-value:last-child').textContent = Math.round(essSOC) + '%';
        
        // Power price (fluctuate based on demand/supply balance)
        const priceBase = 100;
        const priceVariation = (avgDemand - avgSupply) / avgSupply * 20;
        const currentPrice = Math.max(50, Math.min(150, priceBase + priceVariation));
        document.querySelector('.agent-card:last-child .agent-value').textContent = Math.round(currentPrice) + ' ì›/kWh';
        
        // Supply-demand balance
        const balance = avgSupply / avgDemand;
        document.querySelector('.agent-card:last-child .agent-value:nth-child(2)').textContent = balance.toFixed(2);
        
        // Cost efficiency
        const costEfficiency = Math.min(100, Math.round((1 - Math.abs(balance - 1)) * 100));
        document.querySelector('.agent-card:last-child .agent-value:last-child').textContent = costEfficiency + '%';
        
        // Update charts if they exist
        if (typeof updateCharts === 'function') {
            updateCharts(avgDemand, avgSupply, solarGen, windGen, essSOC);
        }
    }
    
    // Update data every 2 seconds
    setInterval(updateRealTimeData, 2000);
    
    // Initial update
    updateRealTimeData();


        // Real-time data update function
        function updateRealTimeData() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            
            // Simulate daily patterns based on time
            const timeOfDay = hour + minute / 60;
            
            // Demand pattern: peaks during morning (8-10) and evening (18-20)
            let demandBase = 50;
            if (timeOfDay >= 8 && timeOfDay <= 10) {
                demandBase = 70 + (timeOfDay - 8) * 5; // Morning peak
            } else if (timeOfDay >= 18 && timeOfDay <= 20) {
                demandBase = 80 + (20 - timeOfDay) * 3; // Evening peak
            } else if (timeOfDay >= 6 && timeOfDay <= 22) {
                demandBase = 55 + Math.sin((timeOfDay - 6) * Math.PI / 16) * 15;
            } else {
                demandBase = 30 + Math.random() * 10; // Night time
            }
            
            // Supply pattern: follows solar generation
            let supplyBase = 50;
            if (timeOfDay >= 6 && timeOfDay <= 18) {
                const solarHour = timeOfDay - 6;
                supplyBase = 60 + Math.sin(solarHour * Math.PI / 12) * 30;
            } else {
                supplyBase = 40 + Math.random() * 10;
            }
            
            // Add random variation
            const avgDemand = Math.max(0, demandBase + (Math.random() - 0.5) * 15);
            const avgSupply = Math.max(0, supplyBase + (Math.random() - 0.5) * 12);
            
            // Update metric values
            document.getElementById('avgDemand').textContent = Math.round(avgDemand);
            document.getElementById('avgSupply').textContent = Math.round(avgSupply);
            
            // Calculate renewable ratio
            const solarGen = timeOfDay >= 6 && timeOfDay <= 18 ? 
                Math.max(0, (timeOfDay - 6) * 3 + (Math.random() - 0.5) * 5) : 0;
            const windGen = 15 + Math.random() * 10;
            const totalRenewable = solarGen + windGen;
            const renewableRatio = avgDemand > 0 ? Math.min(100, Math.round(totalRenewable / avgDemand * 100)) : 0;
            
            document.getElementById('renewableRatio').textContent = renewableRatio;
            
            // Calculate performance score
            const balance = Math.abs(avgDemand - avgSupply) / Math.max(avgDemand, avgSupply, 1);
            const performanceScore = Math.round((1 - balance) * 50 + (renewableRatio / 100) * 50);
            document.getElementById('overallScore').textContent = Math.max(0, Math.min(100, performanceScore));
            
            // Update AI agent cards
            // Active devices
            const activeDevices = Math.floor(15 + Math.random() * 25);
            document.getElementById('activeDevices').textContent = activeDevices;
            
            // Solar power
            document.getElementById('solarPower').textContent = Math.round(solarGen) + ' kW';
            
            // Wind power
            document.getElementById('windPower').textContent = Math.round(windGen) + ' kW';
            
            // ESS SOC (varies based on supply-demand balance)
            const essSOC = Math.max(0, Math.min(100, 60 + (avgSupply - avgDemand) / 10 + (Math.random() - 0.5) * 5));
            document.getElementById('essSOC').textContent = Math.round(essSOC) + '%';
            
            // Power price (fluctuates based on demand/supply balance)
            const priceBase = 100;
            const priceVariation = (avgDemand - avgSupply) / Math.max(avgSupply, 1) * 30;
            const currentPrice = Math.max(50, Math.min(150, priceBase + priceVariation));
            document.getElementById('currentPrice').textContent = Math.round(currentPrice) + ' ì›/kWh';
            
            // Supply-demand ratio
            const supplyDemandRatio = avgDemand > 0 ? (avgSupply / avgDemand).toFixed(2) : 1.0;
            document.getElementById('supplyDemandRatio').textContent = supplyDemandRatio;
            
            // Cost efficiency
            const costEfficiency = Math.min(100, Math.round((1 - Math.abs(parseFloat(supplyDemandRatio) - 1)) * 100));
            document.getElementById('costEfficiency').textContent = costEfficiency + '%';
            
            // Average priority (simulate)
            const avgPriority = (4.5 + Math.random()).toFixed(1);
            document.getElementById('avgPriority').textContent = avgPriority;
        }
        
        // Update data every 2 seconds
        setInterval(updateRealTimeData, 2000);
        
        // Initial update
        updateRealTimeData();
        
        // Also call loadData if CSV exists, otherwise just use real-time data
        loadData().catch(() => {
            console.log('CSV íŒŒì¼ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.');
            updateRealTimeData();
        });

    </script>
</body>
</html>
